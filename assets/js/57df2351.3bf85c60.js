"use strict";(self.webpackChunkzerodoc=self.webpackChunkzerodoc||[]).push([[6800],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>u});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)t=c[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)t=c[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var f=r.createContext({}),o=function(e){var n=r.useContext(f),t=n;return e&&(t="function"==typeof e?e(n):x(x({},n),e)),t},d=function(e){var n=o(e.components);return r.createElement(f.Provider,{value:n},e.children)},_="mdxType",i={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},p=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,c=e.originalType,f=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),_=o(t),p=a,u=_["".concat(f,".").concat(p)]||_[p]||i[p]||c;return t?r.createElement(u,x(x({ref:n},d),{},{components:t})):r.createElement(u,x({ref:n},d))}));function u(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var c=t.length,x=new Array(c);x[0]=p;var s={};for(var f in n)hasOwnProperty.call(n,f)&&(s[f]=n[f]);s.originalType=e,s[_]="string"==typeof e?e:a,x[1]=s;for(var o=2;o<c;o++)x[o]=t[o];return r.createElement.apply(null,x)}return r.createElement.apply(null,t)}p.displayName="MDXCreateElement"},16471:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>s,default:()=>p,frontMatter:()=>x,metadata:()=>f,toc:()=>d});var r=t(87462),a=(t(67294),t(3905)),c=t(79524);const x={},s="\u4f01\u77e5\u9053",f={unversionedId:"rsecu/webjs/3_21",id:"rsecu/webjs/3_21",title:"\u4f01\u77e5\u9053",description:"\u4e3b\u9875\uff1ahttps://www.qizhidao.com/check?searchKey=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD&tagNum=2&fromRoutePage=check",source:"@site/docs/rsecu/webjs/3_21.mdx",sourceDirName:"rsecu/webjs",slug:"/rsecu/webjs/3_21",permalink:"/zerodoc/docs/rsecu/webjs/3_21",draft:!1,tags:[],version:"current",frontMatter:{}},o={},d=[{value:"\u9006\u5411\u5206\u6790",id:"\u9006\u5411\u5206\u6790",level:2},{value:"signature\u53c2\u6570",id:"signature\u53c2\u6570",level:3},{value:"data1\u53c2\u6570",id:"data1\u53c2\u6570",level:3},{value:"\u5b8c\u6574\u4ee3\u7801",id:"\u5b8c\u6574\u4ee3\u7801",level:2}],_={toc:d},i="wrapper";function p(e){let{components:n,...t}=e;return(0,a.kt)(i,(0,r.Z)({},_,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"\u4f01\u77e5\u9053"},"\u4f01\u77e5\u9053"),(0,a.kt)("p",null,"\u4e3b\u9875\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://www.qizhidao.com/check?searchKey=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD&tagNum=2&fromRoutePage=check"},"https://www.qizhidao.com/check?searchKey=%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD&tagNum=2&fromRoutePage=check"),"\n\u63a5\u53e3\uff1a",(0,a.kt)("a",{parentName:"p",href:"https://app.qizhidao.com/qzd-bff-enterprise/qzd/v1/enterprise/zhichan/enterpriseListV2"},"https://app.qizhidao.com/qzd-bff-enterprise/qzd/v1/enterprise/zhichan/enterpriseListV2")),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_1.png")}),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_2.png")}),"\u9006\u5411\u53c2\u6570\uff1asignature\u53c2\u6570\u9006\u5411\u548c\u8fd4\u56de\u7684data1\u52a0\u5bc6\u7834\u89e3",(0,a.kt)("h2",{id:"\u9006\u5411\u5206\u6790"},"\u9006\u5411\u5206\u6790"),(0,a.kt)("h3",{id:"signature\u53c2\u6570"},"signature\u53c2\u6570"),(0,a.kt)("p",null,"\u6253\u5f00\u63a7\u5236\u53f0\u5c31\u51fa\u73b0debugger\uff0c\u9700\u8981\u5148\u8fc7\u6389debugger\uff0c\u76f4\u63a5\u5728\u63a7\u5236\u53f0\u6ce8\u5165\u6e05\u9664debugger\u7684\u811a\u672c\u65e0\u6548\uff0c\u6cb9\u7334debugger\u7f6e\u7a7a\u4e5f\u65e0\u6548\uff0c\u4e8e\u662f\u91c7\u7528\u6700\u539f\u59cb\u7684\uff0c\u770b\u8c03\u7528\u6808\uff0c\u627e\u5230debugger\u7684\u4f4d\u7f6e\u5e76\u7f6e\u7a7a\u3002\u7f51\u7ad9\u6bd4\u8f83\u6076\u5fc3\uff0c\u52a0\u8f7d\u4e866\u4e2ajs\u6587\u4ef6\uff0c\u6bcf\u4e2a\u6587\u4ef6\u90fd\u4f1a\u8fdb\u5165\u65e0\u9650debugger"),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_3.png")}),"\u5176\u4e2d\u4e00\u4e2ajs\u6587\u4ef6\u7684debugger",(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_4.png")}),(0,a.kt)("p",null,"\u63a7\u5236\u53f0\u7f6e\u7a7a\u6240\u6709debugger\uff0c\u65b9\u5f0f\u662f\u9047\u5230\u4e00\u4e2adebugger\uff0c\u5c31\u56de\u5230\u8c03\u7528\u7684\u5730\u65b9\uff0c\u7136\u540e\u7f6e\u7a7a\u5177\u4f53\u7684\u51fd\u6570"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"_0x3b1227 = function(){}\n\n_0x3ef3a5 = function(){}\n\n_0x34e175 = function(){}\n\n_0x5da3d0 = function(){}\n\n_0x56982e = function(){}\n\n_0x206583 = function(){}\n\n\n")),(0,a.kt)("p",null,"\u8fc7\u4e86debugger\u4e4b\u540e\u5c31\u5f00\u59cb\u8c03\u8bd5\uff0c\u9996\u5148\u91c7\u7528\u4e86hook header\u4e2dsignature\u53c2\u6570\u7684\u65b9\u5f0f\uff0c\u4f46\u662f\u7531\u4e8epromise\u5b9e\u5728\u662f\u592a\u591a\u4e86\uff0c\u8fd8\u662f\u627e\u4e0d\u5230\u52a0\u5bc6\u7684\u5730\u65b9\uff0c\u6700\u540e\u91c7\u7528\u7b28\u529e\u6cd5\u4e00\u6b65\u4e00\u6b65\u8c03\u8bd5\u603b\u7b97\u627e\u5230\u4e86\u52a0\u5bc6\u7684\u5730\u65b9"),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_5.png")}),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"_0x24d112['headers'][_0x188ee1(0x367)] = _0x14cc63 ? _0x547bed(_0x24d112[_0x188ee1(0x259f)]) : _0x2cdce0(Object(_0x330954['c'])(_0x188ee1(0x275c) + 'n', _0x40912f), Object(_0x330954['a'])(_0x40912f))\n")),(0,a.kt)("p",null,"\u7b80\u5316\u4e0a\u8ff0\u7684\u903b\u8f91\uff0c\u53d1\u73b0\u5165\u53c2\u90fd\u662fundefined\uff0c\u56e0\u6b64\u53ea\u9700\u8981\u6263_0x2cdce0\u8fd9\u4e00\u4e2a\u51fd\u6570\u5c31\u597d\u4e86\uff0c\u4e0b\u9762\u5c31\u662f\u4e00\u901a\u8865\u73af\u5883\uff0c\u8fd9\u91cc\u6bd4\u8f83\u5173\u952e\u7684\u5730\u65b9\u662f\u4e00\u4e2a\u5927\u6570\u7ec4\uff0c\u5927\u6570\u7ec4\u91cc\u9762\u5c31\u662f\u4e00\u4e2a\u4f7f\u7528\u7684\u5173\u952e\u5b57\uff0c\u901a\u8fc7\u4e0b\u6807\u53bb\u53d6\uff0c\u4ee5\u53ca\u4e00\u6bb5\u5bf9\u5927\u6570\u7ec4\u79fb\u4f4d\u7684\u4ee3\u7801\u903b\u8f91\uff0c\u6700\u5f00\u59cb\u5fd8\u8bb0\u8865\u8fd9\u6bb5\u4ee3\u7801\u4e86\uff0c\u5bfc\u81f4\u6570\u7ec4\u4e0d\u5bf9\u3002"),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_6.png")}),"\u6700\u540e\u53d1\u73b0\u6838\u5fc3\u52a0\u5bc6\u903b\u8f91\u5c31\u662f\u4e00\u4e2a\u539f\u751f\u7684md5~\u6298\u817e\u8fd9\u4e48\u4e45\uff0c\u6263\u4ee3\u7801\u5012\u662f\u5f88\u987a\u5e8f",(0,a.kt)("h3",{id:"data1\u53c2\u6570"},"data1\u53c2\u6570"),(0,a.kt)("p",null,"\u6709\u4e86\u7b2c\u4e00\u4e2a\u53c2\u6570\u7684\u7ecf\u9a8c\uff0c\u54cd\u5e94\u6570\u636e\u7684\u52a0\u5bc6\u5c31\u5f88\u7b80\u5355\u4e86\uff0c\u5728\u5206\u6790signature\u7684\u65f6\u5019\uff0c\u53d1\u73b0\u4e0b\u9762\u8fd9\u6837\u7684\u7ed3\u6784\uff0c\u90a3\u4e48\u76f2\u731c\u54cd\u5e94\u6570\u636e\u7684\u89e3\u6790\u5c31\u5728rep\u4e2d\uff0c\u6838\u5fc3\u53bb\u627eJSON.parse\uff0cparse\u7684\u5165\u53c2\u5927\u6982\u7387\u5c31\u662f\u89e3\u5bc6\u540e\u7684\u6570\u636e\uff0c\u540c\u65f6\u4e00\u822c\u89e3\u5bc6\u51fd\u6570\u4e5f\u5728\u6b64"),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_7.png")}),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_8.png")}),"\u5178\u578b\u7684aes\uff0c\u5c31\u4e0d\u6263\u4ee3\u7801\u4e86",(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_9.png")}),(0,a.kt)("h2",{id:"\u5b8c\u6574\u4ee3\u7801"},"\u5b8c\u6574\u4ee3\u7801"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-js"},"var CryptoJS = require('crypto-js')\n\nfunction md5(text) {\n    return CryptoJS.MD5(text).toString()\n}\nfunction a43_0x3511() {\n    var _0x12adf2 = []  // \u8fd9\u91cc\u5c31\u662f\u5927\u6570\u7ec4\n  a43_0x3511 = function() {\n        return _0x12adf2;\n  };\n  return a43_0x3511();\n}\n\n\nvar a43_0x1ee926 = a43_0x46c5;\n// \u81ea\u6267\u884c\u51fd\u6570 \u5bf9\u6570\u636e\u8fdb\u884c\u4e86\u79fb\u4f4d\n(function(_0x2e644b, _0xbbee32) {\n    var _0x4f664f = a43_0x46c5\n      , _0x39c23d = _0x2e644b();\n    while (!![]) {\n        try {\n            var _0x1b10d1 = -parseInt(_0x4f664f(0x215e)) / 0x1 + -parseInt(_0x4f664f(0x2a23)) / 0x2 * (-parseInt(_0x4f664f(0x189b)) / 0x3) + -parseInt(_0x4f664f(0x296a)) / 0x4 * (parseInt(_0x4f664f(0xa10)) / 0x5) + parseInt(_0x4f664f(0x174c)) / 0x6 * (parseInt(_0x4f664f(0x1de)) / 0x7) + parseInt(_0x4f664f(0x1283)) / 0x8 * (parseInt(_0x4f664f(0x875)) / 0x9) + parseInt(_0x4f664f(0x68f)) / 0xa * (parseInt(_0x4f664f(0x1f8e)) / 0xb) + -parseInt(_0x4f664f(0x24cb)) / 0xc * (-parseInt(_0x4f664f(0x10ff)) / 0xd);\n            if (_0x1b10d1 === _0xbbee32)\n                break;\n            else\n                _0x39c23d['push'](_0x39c23d['shift']());\n        } catch (_0x598912) {\n            _0x39c23d['push'](_0x39c23d['shift']());\n        }\n    }\n}(a43_0x3511, 0xcc3e8));\n// \u6570\u7ec4\u79fb\u4f4d\u4e86\nfunction a43_0x46c5(_0xc3d67f, _0x1fb6f8) {\n    var _0x575c4f = a43_0x3511();\n    return a43_0x46c5 = function(_0x181972, _0x31f5de) {\n        _0x181972 = _0x181972 - 0x17f;\n        var _0x147cb5 = _0x575c4f[_0x181972];\n        return _0x147cb5;\n    }\n    ,\n    a43_0x46c5(_0xc3d67f, _0x1fb6f8);\n}\n\nfunction _0x2cdce0(_0x2c2b13, _0x21cfbf) {\n    var _0x4b21c4 = function(_0x2ffbbf, _0x2e3768, _0x3167d5) {\n        var _0x3dcd63 = a43_0x46c5, _0xac5b2c, _0x1aec10 = '';\n        void 0x0 === _0x2ffbbf && (_0x2ffbbf = 0x6),\n        _0x3dcd63(0x1667) == typeof _0x2e3768 && (_0x3167d5 = _0x2e3768),\n        _0xac5b2c = _0x2e3768 && 'number' == typeof _0x2e3768 ? Math['round'](Math[_0x3dcd63(0x19c8)]() * (_0x2e3768 - _0x2ffbbf)) + _0x2ffbbf : _0x2ffbbf,\n        _0x3167d5 = _0x3167d5 || _0x3dcd63(0x1406) + _0x3dcd63(0xdb6) + _0x3dcd63(0x1191) + 'efghijklmn' + _0x3dcd63(0x9c6) + _0x3dcd63(0x1ae3) + '89';\n        for (var _0x273add = 0x0; _0x273add < _0xac5b2c; _0x273add++) {\n            var _0x4898f5 = Math['round'](Math[_0x3dcd63(0x19c8)]() * (_0x3167d5[_0x3dcd63(0x276c)] - 0x1));\n            _0x1aec10 += _0x3167d5[_0x3dcd63(0x702)](_0x4898f5, _0x4898f5 + 0x1);\n        }\n        return _0x1aec10;\n    }()\n      , _0x25bb37 = md5(_0x4b21c4);\n    return md5(_0x25bb37 + _0x2c2b13 + _0x21cfbf) + '.' + _0x4b21c4;\n}\n\n// _0x4f16a5 \u9a8c\u8bc1\u662f\u4e2amd5\n// _0x2cdce0(Object(_0x330954['c'])('accessToken', _0x40912f), undefined),\n// \u4e24\u4e2a\u53c2\u6570\u90fd\u662fundefined\nconsole.log(_0x2cdce0());\n\nvar data=''\nfunction tripleAesDecrypt(data) {\n    var aesKey = 'I8V3IwIhrwNbWxqz'\n    var key = CryptoJS.enc.Utf8.parse(aesKey),\n        // iv = CryptoJS.enc.Utf8.parse(aesIv),\n        // CBC \u52a0\u5bc6\u65b9\u5f0f\uff0cPkcs7 \u586b\u5145\u65b9\u5f0f\n        decrypted = CryptoJS.AES.decrypt(data, key, {\n            // iv: iv,\n            mode: CryptoJS.mode.ECB,\n            padding: CryptoJS.pad.Pkcs7\n        });\n    return decrypted.toString(CryptoJS.enc.Utf8);\n}\nconsole.log(tripleAesDecrypt(data));\n")),(0,a.kt)("p",null,"\u6267\u884c\u7ed3\u679c\u548csignature\u53c2\u6570\u7ed3\u6784\u4e00\u81f4"),(0,a.kt)("img",{alt:"\u4f01\u77e5\u9053\u52a0\u5bc6\u9006\u5411",src:(0,c.Z)("/images/rsecu/webjs/3_21_10.png")}))}p.isMDXComponent=!0}}]);