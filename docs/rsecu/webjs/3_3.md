# 常见加密解密算法 

内容较难，务必耐心。

计算机领域有很多加密算法，这里只整理在逆向和爬虫中的加密算法。就是网站经常使用的那些加密算法。同时使用JS和PY加以说明。

## 常见加密

### 加密
1. 对称加密（加密解密密钥相同）：DES、3DES、AES、RC4、Rabbit
2. 非对称加密（区分公钥和私钥）：RSA、DSA、ECC
3. 消息摘要算法/签名算法：MD5、SHA、HMAC、PBKDF2

### 编码
还有一个混淆编码算法，一般情况下，此Base64算法用的不多，经常是Base64变体用的多，如按照Base64规则自定义的加密算法较多。
常见编码算法：Base64

## JS加密算法常用

### Crypto-JS
Crypto-JS 支持 MD5、SHA、RIPEMD-160、HMAC、PBKDF2、AES、DES、3DES（Triple DES）、Rabbit、RC4 等，不支持 RSA、ECC
地址： https://github.com/brix/crypto-js

### Node-RSA

Node-RSA 补充支持 RSA ，主要问题是RSA过分复杂了。

地址：https://github.com/rzcoder/node-rsa

### JSEncrypt

JSEncrypt 主要支持 RSA 算法

地址：https://github.com/travist/jsencrypt

## Python加密解密库

### Cryptodome & Crypto

Cryptodome 支持几乎所有主流加密算法，包括 MD5、SHA、BLAKE2b、BLAKE2s、HMAC、PBKDF2、AES、DES、3DES（Triple DES）、ECC、RSA、RC4 等
地址： https://www.pycryptodome.org/

强调一点：
Cryptodome 是 Crypto 的替代品，Crypto 有很多未知错误，以后不要用。这里就不放地址了。

Cryptodome 使用命令 `pip install pycryptodome` 进行安装，Crypto 使用命令 `pip install pycrypto` 进行安装。

### Hashlib
比较好用，特别是针对只会前端JS的Python程序员。
地址：https://docs.python.org/3/library/hashlib.html
hashlib 提供了常见的摘要算法，如 MD5，SHA、BLAKE2b、BLAKE2s 等

### HMAC
Python 的标准库 hmac 对 HMAC 算法提供了支持。

hmac 库：https://docs.python.org/3/library/hmac.html

### pyDes

Python 的第三方库 pyDes 对 DES 算法提供了支持。使用命令 pip install pydes 进行安装。

参考资料：pyDes 库：https://github.com/twhiteman/pyDes

### ESA

Python 的第三方库 rsa 对 RSA 算法提供了支持。使用命令 pip install rsa 进行安装。

参考资料：rsa 库：https://stuvel.eu/python-rsa-doc/

## 所有加密算法的都会有的参数

初始向量 iv、加密模式 mode、填充方式 padding

### 初始向量 iv
在密码学的领域里，初始化向量（英语：initialization vector，缩写为IV），或译初向量，又称初始变量（starting variable，缩写为SV），是一个固定长度的输入值。一般的使用上会要求它是随机数或拟随机数（pseudorandom）。

### 加密模式 mode

注意：不要觉得多，未来有一天总会用到的。往往高级程序员和低级程序员的区别就在此处。

目前流行的加密和数字认证算法，都是采用块加密方式，就是将需要加密的明文分成固定大小的数据块，然后对其执行密码算法，得到密文。数据块的大小通常采用跟密钥一样的长度。加密模式在加密算法的基础上发展出来，同时也可以独立于加密算法而存在，加密模式定义了怎样通过重复利用加密算法将大于一个数据块大小的明文转化为密文，描述了加密每一数据块的过程。目前利用较多的加密模式有以下几种：

- ECB：Electronic Code Book（电子码本模式），是一种基础的加密方式，密文被分割成分组长度相等的块（不足补齐），然后单独一个个加密，一个个输出组成密文。

- CBC：Cipher Block Chaining（密码块链接模式），是一种循环模式，前一个分组的密文和当前分组的明文异或操作后再加密，这样做的目的是增强破解难度。

- PCBC：Propagating Cipher Block Chaining（填充密码块链接模式），也称为明文密码块链接模式（Plaintext Cipher Block Chaining），是一种可以使密文中的微小更改在解密时导致明文大部分错误的模式，并在加密的时候也具有同样的特性。

- CFB：Cipher Feedback（密码反馈模式），可以将块密码变为自同步的流密码，类似于 CBC，CFB 的解密过程几乎就是颠倒的 CBC 的加密过程。

- OFB：Output Feedback（输出反馈模式），可以将块密码变成同步的流密码，它产生密钥流的块，然后将其与明文块进行异或，得到密文。与其它流密码一样，密文中一个位的翻转会使明文中同样位置的位也产生翻转。

- CTR：Counter mode（计数器模式），也被称为 ICM 模式（Integer Counter Mode，整数计数模式）和 SIC 模式（Segmented Integer Counter），在 CTR 模式中，有一个自增的算子，这个算子用密钥加密之后的输出和明文异或的结果得到密文，相当于一次一密。这种加密方式简单快速，安全可靠，而且可以并行加密，但是在计算器不能维持很长的情况下，密钥只能使用一次。


### 填充方式 padding

块密码只能对确定长度的数据块进行处理，而消息的长度通常是可变的。因此部分模式最后一块数据在加密前需要进行填充。有数种填充方法，其中最简单的一种是在明文的最后填充空字符以使其长度为块长度的整数倍。常见填充方式有以下几种：

- PKCS7：在填充时首先获取需要填充的字节长度 = 块长度 - （数据长度 % 块长度）, 在填充字节序列中所有字节填充为需要填充的字节长度值。

- PKCS5：PKCS5 作为 PKCS7 的子集算法，概念上没有什么区别，只是在 blockSize 上固定为 8 bytes，即块大小固定为 8 字节。

- ZeroPadding：在填充时首先获取需要填充的字节长度 = 块长度 - （数据长度 % 块长度）, 在填充字节序列中所有字节填充为 0 。

- ISO10126：在填充时首先获取需要填充的字节长度 = 块长度 - （数据长度 % 块长度），在填充字节序列中最后一个字节填充为需要填充的字节长度值，填充字节中其余字节均填充随机数值。

- ANSIX923：在填充时首先获取需要填充的字节长度 = 块长度 - （数据长度 % 块长度），在填充字节序列中最后一个字节填充为需要填充的字节长度值，填充字节中其余字节均填充数字零。



